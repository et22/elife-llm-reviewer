TITLE
Eco-evolutionary dynamics of adapting pathogens and host immunity

ABSTRACT
As pathogens spread in a population of hosts, immunity is built up, and the pool of susceptible individuals are depleted. This generates selective pressure, to which many human RNA viruses, such as influenza virus or SARS-CoV-2, respond with rapid antigenic evolution and frequent emergence of immune evasive variants. However, the host’s immune systems adapt, and older immune responses wane, such that escape variants only enjoy a growth advantage for a limited time. If variant growth dynamics and reshaping of host-immunity operate on comparable time scales, viral adaptation is determined by eco-evolutionary interactions that are not captured by models of rapid evolution in a fixed environment. Here, we use a Susceptible/Infected model to describe the interaction between an evolving viral population in a dynamic but immunologically diverse host population. We show that depending on strain cross-immunity, heterogeneity of the host population, and durability of immune responses, escape variants initially grow exponentially, but lose their growth advantage before reaching high frequencies. Their subsequent dynamics follows an anomalous random walk determined by future escape variants and results in variant trajectories that are unpredictable. This model can explain the apparent contradiction between the clearly adaptive nature of antigenic evolution and the quasi-neutral dynamics of high-frequency variants observed for influenza viruses.

INTRODUCTION
Many human RNA viruses adapt rapidly to evade pre-existing immunity and re-infect humans multiple times over their lifetime. The most prominent examples of this evolution are influenza virus and SARS-CoV-2 (Roemer et al., 2023; Petrova and Russell, 2018), for which the changing virus population is surveilled in great detail and vaccines are updated regularly. To improve the match between the virus population and the vaccine, several groups are working on predictive models to anticipate the variants that dominate future viral populations (Morris et al., 2018; Meijers et al., 2023).
A common framework to model the rapid evolutionary dynamics of RNA viruses is to consider a population located away from the fitness optimum and with many accessible beneficial mutations (Tsimring et al., 1996). In this setting, clones compete to accumulate beneficial mutations as quickly as possible. In a process called selective sweep, successful variants expand and tend to be the ancestors of the future population while less successful mutants eventually disappear. The resulting fitness distribution is a wave traveling along the fitness axis, the so-called traveling fitness waves Rouzine et al., 2003; Desai and Fisher, 2007; Neher, 2013. As the pathogen circulates, hosts develop immunity which leads to a ‘deterioration of the environment’ for the pathogen which approximately balances the increase in average fitness due to adaptation.
The traveling wave framework has been extensively used in this context as it allows for a straightforward ways to approach the prediction problem: each variant is assumed to have a fixed fitness relative to other variants, and inferring the fitness of all competing variants should allow prediction of the future composition of the population. Indeed, current methods typically infer the instantaneous growth advantage of a strain based on past and present circulation and then project this growth advantage forward in time Luksza and Lässig, 2014; Neher et al., 2014; Huddleston et al., 2020. While future mutations can reshuffle the relative fitness of lineages and thereby limit predictability, in these models a lineage that is most fit at any given time is most likely to dominate in the long run.
One short-coming of the traveling wave approach is the lack of explicit representation of the epidemiological dynamics and of the host’s immunity. Indeed, fitness is only an effective parameters that summarize the complex interplay between viral antigenic properties and the hosts’ immune systems. As such, it cannot explicitly describe important phenomena such as the build-up of host immunity to new variants, variant-specific immunity, or the interaction between strains through antigenic cross-reactivity. Taking the hosts’ immunity and viral cross-immunity into account has the potential to strongly improve predictions Meijers et al., 2023 or explain why prediction is difficult (Barrat-Charlaix et al., 2021).
The interaction between epidemiological dynamics and hosts’ immunity are often modeled using generalizations of the Susceptible-Infected-Recovered model (SIR) to include multiple viral strains Gupta et al., 1998; Gog and Grenfell, 2002. In this setting, the natural question is that of the ultimate fate of the pathogen: will it go extinct, diversify to the point of speciation, or reach the so-called Red Queen State where new strains continuously replace old ones Yan et al., 2019; Marchi et al., 2021; Chardès et al., 2023; Rouzine and Rozhnova, 2018. To remain tractable, these studies typically approximate population immunity as a low-dimensional landscape in which the viral population evolves and ignores the complex heterogeneity in the immunity of different individuals. Furthermore, immunity is often assumed to be long-lived, and evolution of the pathogen in a stable low dimensional landscape gives rise to traveling waves.
Here, we study how novel variants of a virus shape the host population’s immunity, which in turn changes their own growth dynamics. To do so, we use a multi-strain SIR model combining immune waning and heterogeneous immunity of the hosts. Such heterogeneity has been demonstrated for influenza virus in individuals of different ages Lee et al., 2019; Welsh et al., 2023. We show that this model generically leads to a situation where novel immune evasive variants emerge. In a homogeneous population of hosts, this leads to a succession of selective sweeps where novel variants compete against each other and replace previously circulating variants. However, in a heterogeneous population with a more rapid waning of immunity, initially growing variants lose their selective advantage before reaching fixation due to immunological adjustment of the host population. The phenomenology of our epidemiological model is reminiscent of ecological systems such as consumer-resource models, where adaptation by one species shifts the global equilibrium and distribution of other species but does not necessarily result in a selective sweep Good et al., 2018. In these systems, adaptation can usually not be modeled by a fixed fitness parameter for each strain but rather depends on the composition of the population Tikhonov and Monasson, 2018.
Strain dynamics in our model differ qualitatively from what is expected in the traveling wave scenario. While adaptive mutations are highly overrepresented in genetic diversity, they cease having a growth advantage when reaching intermediate frequencies, a process we call ‘expiring fitness.’ Once the fitness effect of a mutation has expired, its frequency randomly changes up or down as subsequent adaptive mutations occur on the same or on different genomic backgrounds.
This resemblance to neutral evolution could have important consequences for predictability of viral evolution. It is interesting to relate this to the recent observations that the evolution of influenza is not as predictable as one would expect from typical models Huddleston et al., 2020; Barrat-Charlaix et al., 2021. In particular, we observed in Barrat-Charlaix et al., 2021 that the frequency trajectories of mutants of A/H3N2 influenza show features that are expected in neutral evolution but hard to explain in a traveling wave framework.

RESULTS
Multi-strain SIR model
We describe the interaction of several viral strains and host immunity using a Susceptible/Infected compartmental model, similar to those used in Gog and Grenfell, 2002; Yan et al., 2019. In the most general form, the model describes N variants of the virus labeled a∈{1…N} circulating among M groups of hosts with distinct exposure histories labeled i∈{1…M} (immune groups). These groups could be different age cohorts or could be geographically separated. For each group i, we define compartments Iia and Sia as, respectively, the number of individuals of this group infected or susceptible to strain a. We assume that the total population of hosts is 1 so that we always have 0≤Iia,Sia≤1, and values of Iia and Sia can be interpreted as fractions of the host population.
As with usual compartmental models, we assume that the dynamics are driven by the interaction of susceptible and infected hosts, leading to infections and gains of immunity. The rate at which hosts of group i susceptible to variant a are infected by a is αSia∑j=1MCijIja. Here, α is an overall infection rate while Cij represents the probability of an encounter between individuals of groups i and j. Thus, the above rate takes into account infections with strains a caused by hosts of all groups. Considering that infected hosts recover at rate δ, we can thus write the dynamics for Iia:
When a host of group i is infected by strain b, it gains immunity against the infecting strain b, but also to other strains a with probability 0≤Kiab≤1. Thus, Sia decreases at a rate proportional to Kiab and to the number of hosts infected by b for every strain b. Since susceptibles to a are depleted by infections from other strains, the dynamics of all strains are coupled. This coupling is determined by the matrices Ki of dimension N×N, which in general differ between groups i with different prior exposure history. Additionally, the waning of immunity at a rate γ causes immune hosts to re-enter the susceptible compartment. We can now write the dynamics of Sia as
where the first term accounts for immunity gains (or loss of susceptibility) due to infections or cross-immunity while the second represents immune waning. This model introduced by Gog and Grenfell, 2002 assumes that immunity builds up through exposure and not only through infection. This explains that the change in Sia is simply proportional to Sia⋅Ijb, regardless of the susceptibility of hosts to strain b. Alternative models that require infection for acquisition of immunity have qualitatively similar dynamics, but are mathematically more complex (Appendix 1.5). We also represented loss of susceptibility to a due to exposure to a using a trivial cross-immunity term Kiaa=1.
An important property of our model is that the probability of generating cross-immunity can differ between groups. The motivation is that strains a and b may be perceived as antigenically different by some immune systems, leading to a low Kiab, but as highly similar by others, leading to Kiab≃1. Such a heterogeneous response by different immune systems has been observed experimentally in the case of influenza: in Lee et al., 2019; Welsh et al., 2023 for instance, it was found that a given mutation in an influenza strain may allow escape from the antibodies of some individuals, i.e., low Kiab, while it had little effect on the serum of other individuals, i.e., high Kiab. Heterogeneous immune response could be caused by varying histories of strain exposure for different individuals, for instance, due to differences in age or geographical region. If immune groups correspond to age cohorts, mixing between groups is rapid, and we can simplify the connectivity between groups to Cij=1/M. If immune groups are shaped by geographic differences in exposure, the connectivity would be close to 1 on the diagonal (1−Cii≪1) while off-diagonal terms would be small (Cij≪1 for i≠j).

Invasion of an adaptive variant
Hosts’ immune heterogeneity and strain cross-immunity play two different roles in the model. The latter allows the model to reach a non-trivial equilibrium where multiple strains co-exist, while the former affects the convergence to the equilibrium.
To illustrate this, we design a simple scenario with only two strains: a wild-type and a variant. Accordingly, indices (a,b) describing strains will take values {wt,v}. We consider that the two strains share the same infectivity rate α, which amounts to say that they would have the same reproductive rate in a fully naive population. The case where the two strains differ in intrinsic fitness is explored in detail in Appendix 1.7. In brief, as long as the difference in intrinsic fitness is not too large compared to cross-immunity effects, the qualitative results given below hold, while larger intrinsic fitness differences lead to more classical dynamics like selective sweeps.
In the first version of this scenario, we will only consider one immune group, that is M=1. We can thus skip the indices i,j∈{1…M}, and we only have one cross-immunity matrix K that we parametrize as
with 0≤b,f≤1 . b quantifies the amount of ‘backward’-immunity to the wild-type caused by the variant: a large b means that it is likely that an infection by the variant causes immunity to the wild-type. Conversely, f quantifies the ‘forward’-immunity: infections by the wild-type causing immunity to the variant. If f=b=1, the two strains are antigenically indistinguishable, and thus essentially identical for the model. Conversely, if f=b=0, the two strains are completely distinct and do not interact through cross-immunity.
The dynamical equations now take a simplified form:
We can immediately derive the equilibrium state for this simplified case. We first define the reproductive number of strain a as Ra=αSa/δ. Ia grows when Ra&gt;1 and declines when Ra&lt;1. The equilibrium susceptibility is, therefore, Sa=δ/α, such that Ra=1. On the other hand, the equilibrium prevalence is determined by the inverse of the cross-immunity matrix K:
with 1→ being the vector [1;1]. The order of magnitude of the prevalence is given by the ratio of the rate of waning γ(1−δ/α) and the recovery rate δ. In the following, we frequently use values α=3 and γ=5⋅10−3 in units of inverse generations δ, i.e., we set δ=1. At equilibrium, this corresponds to a fraction of ∼0.003 of the host population being infected at any time. If generation time is a week, which is roughly the case for respiratory viruses such as influenza virus or SARS-CoV-2, the fraction of hosts infected in any year is ∼0.15, which is of similar magnitude as empirical estimates for influenza (Kucharski et al., 2018).
It is also straightforward to compute the fraction of infections caused by the variant at equilibrium, thereafter referred to as the frequency of the variant. We find that this frequency is
In the case where b=f, the variant will ultimately settle at frequency 1/2. This includes the case where b=f=0, where the two strains are completely independent and do not interact. On the contrary if b≠f, the final frequency of the variant can in principle be anywhere between 0 and 1. For example if b&gt;f, the variant is more likely to cause immunity to the wild-type than the wild-type is to cause immunity to the variant. In this case, β&gt;1/2 and the variant will be the dominant variant.
We are primarily interested in an ‘invasion’ scenario where only the wild-type is initially present in the population, that is Iv=0 at t&lt;0. Cross-immunity with the resident strain reduces the fraction of hosts susceptible to the variant below one even though it has not circulated yet. But the number of susceptible hosts is always larger than the equilibrium value δ/α unless f=1, As a result, the growth rate of the variant is initially positive and given by
The variant thus increases initially exponentially until it has become sufficiently frequent that it starts having a substantial effect on the immunity landscape, before eventually settling into an equilibrium with the wild-type. The details of the equilibrium reached by the system in the absence of additional mutant variants is given in Appendix 1.1. Figure 1 explores different scenarios numerically.
Figure 1: Invasion of animmune escape mutant. Top row: one immune group, Middle row: M=10 immune groups and fast mixing Cij=1/M and Bottom row M=10 immune groups and slow mixing Cij=1/10M. Other parameters are the same for all rows: in units of δ, we set α=3 and γ=5⋅10−3, and f=0.65, b=0.8, ε=0.01. For both rows, graphs represent: Left: number of hosts infectious with the wild-type and the variant; Middle: number of hosts susceptible to the wild-type and the variant, with the equilibrium value δ/α as a gray line; Right: fraction of the infections due to the variant. The thick gray line shows the expected equilibrium frequency β in the case with one immune group, given in Equation 6. The dashed line shows the trajectory of a constant fitness logistic growth with the same initial growth rate.
The top row of Figure 1 shows the dynamics of the model after the introduction of the variant in a homogeneous population (M=1). As expected, the number of infections by the variant initially rises while the number of susceptibles Sv decreases. However, as Sv goes below the critical value δ/α, Iv starts to decline and then oscillates around the equilibrium value before finally converging to it. The mathematical properties of these oscillations are discussed in Appendix 1.8.
However, these strong and slowly damped oscillations are not what is observed in circulating viruses. For instance, in the first oscillation in the specific example of Figure 1, the prevalence of the wild-type Iwt goes down to microscopic levels and the frequency of the variant approaches one, see Figure 1. During stochastic circulation in a finite population of hosts the wild-type would likely be lost. The theoretical equilibrium that is reached at long times is thus not very relevant, and what would be actually observed in reality is a selective sweep by the variant.
Oscillations are the consequence of the rapid rise of the variant followed by an overshoot. This effect is mitigated by immunological heterogeneity, as shown in the following example with M=10 groups. For group i=1, the cross-immunity matrix K1 takes the same form as in the previous scenario, given by Equation 3. However, for other groups, we assume that the two strains are virtually identical, with the cross-immunity having the form
where ε≪1. Our reasoning is that we expect an adaptive variant to escape the existing immunity for part of the host population, here immune group 1, while having little effect on the rest of the hosts.
One consequence of many groups that are indifferent to the variant is that globally the excess susceptibility to the variant is lower. If mixing is rapid, the initial growth rate of the variant is smaller by a factor of M compared to the one-group case. If mixing is slow, the initial growth of the variant is as rapid as in the one-group case, but then spreads only slowly across groups. Globally, the frequency of the variant thus never reaches values close to one and population-wide oscillations are reduced.
The central and bottom rows of Figure 1 show the result of the invasion for M groups, respectively, for the rapid and slow mixing cases. In both scenarios, the initial number of hosts susceptible to the variant are now closer to δ/α. When mixing is fast, the frequency of the variant initially resembles a standard selective sweep (dashed line in Figure 1) before saturating, while dynamics are more complicated for the slow mixing case. Either way, the main effect of the immune groups is that the overshoot past the equilibrium is much smaller and the dampening of the oscillations stronger. As a result, the frequency of the variant approaches its equilibrium value without effectively sweeping to fixation before.
Notably, the equilibrium frequency in the above examples does not depend on M and Equation 6 remains valid for ε=0. This invariance is a consequence of the fact that for ε=0, the variant and wild-type strains are completely equivalent in immune groups i&gt;1 and equilibrium is only determined by cross-immunity in group i=1 (Appendix 1.4). For small ε the equilibrium shifts slightly, but Equation 6 remains a good approximation.
While this simple two-strain model predicts that the two strains come to an equilibrium at frequency β, their frequency will of course continue to change due to the emergence of additional strains, which we will discuss below.
Even though the variant has a clear growth rate advantage when it appears, this does not result in it replacing the wild-type. This contrasts with the typical ‘selective sweep’ that occurs when the growth rate advantage stays constant, which is illustrated as a dashed line in the figure. We refer to frequency trajectories of a variant that at first rise exponentially before settling at an intermediate frequency as partial sweeps. As we will discuss below, such partial sweeps can lead to qualitatively different evolutionary dynamics and its predictability.
If the initial growth is due to higher susceptibility, it is misleading to think of it as an intrinsic fitness advantage of the variant. Instead, the initial growth is the result of an imbalance in the immune state of the host population, which gradually disappears as the variant becomes more frequent, as shown in the central panels of Figure 1. In this sense, our model is comparable to ecological systems where interaction between organisms cannot be fully explained using a fixed scalar fitness for each strain but rather depends on the composition of the viral and host population. In particular, the stalling of frequency increase gives rise to the partial sweep is reminiscent of consumer resource models Tikhonov and Monasson, 2018; Good et al., 2018, highlighting the link between ecological and epidemiological models. An important consequence of these dynamics is that predicting the equilibrium frequency reached by the variant and its ultimate fate is hard from the observation of a partial frequency trajectory.

Ultimate fate of the invading variant
In the invasion scenario discussed above, dynamics stop after the initial variant has reached an equilibrium frequency. However, as the viral population evolves, new adaptive mutants can appear. In the framework of the SIR model, a new strain translates into extending the cross-immunity matrix by one row and one column. Each new variant will perform its own partial sweep, and saturate at frequencies β2,β3,… sampled from some distribution Pβ. This process is shown in panel A of Figure 2, using the SIR model to simulate up to N=7 variants. For the sake of illustration, it shows a simple scenario where the initial variant appears at time 0 in a homogeneous wild-type population, and subsequent mutants appear at regular time intervals. Simulations are performed using M=10 immune groups, resulting in a slight overshoot of the equilibrium frequency for each trajectory.
Figure 2: Dynamics of partial sweeps and subsequentfixation. (A) Simulation of Susceptible-Infected-Recovered (SIR) Equation 1 &amp; Equation 2 with additional strains appearing at regular time intervals. The fraction of infections (frequency) caused by each strain is shown as a function of time. The first strain to appear at t=0 is the variant of interest, and curves are shown in shades of red if they appear on the background of this variant, and of blue if they appear on the background of the wild-type. (B) Same as A but with frequencies stacked vertically. The black line delimiting the red and blue areas represents the frequency at which the mutations defining the original variant are found. (C) Three realizations of the random walk of Equation 9, all starting at x≃0.5. Two instances converge rapidly to frequencies 0 and 1, corresponding to apparent selective sweeps, while the remaining one oscillates for a longer time. (D) Representation of a partial sweep using the expiring fitness parametrization of Equation 11. The frequency x of the variant is shown as a blue line saturating at value β (gray line). The thin dashed line shows a selective sweep with constant fitness advantage s0. The fitness s is a red dashed line, using the right-axis.
Here, we focus on the mutation or set of mutations A that defines the initial variant. The initial growth rate advantage given by A eventually disappears, meaning that after some times we can consider it as neutral. As subsequent mutants appear, they either do so on the background of the wild-type, in which case they do not carry A, or on the background of the initial variant in which case they do carry A. If we suppose that recombination is negligible, the frequency of A increases or decreases as each new variant undergoes its own partial sweep. This process is shown in panel B of Figure 2, with shades of red (resp. blue) indicating a variant carrying A (resp. not carrying A). The thick line in between the red and blue surfaces indicate the frequency at which mutation A is found, and in practice moves up and down randomly.
The scenario illustrated in Figure 2 suggests that many aspects of the variant dynamics can be approximated by a simple abstraction: if x is the frequency of a mutation A, a new variant has a probability x to appear on the background of A and thus carry A, and a probability 1−x to not carry A. If new mutants emerge well separated in time with rate ρ, meaning that they reach equilibrium before the next variant emerges, and if new variants have a similar cross-immunity with all existing variants (see Appendix 1.6), the dynamics of x(t) are described by a particular random walk: in each time interval dt, a partial sweep of amplitude β occurs with probability ρdt⋅Pβ(β), changing x in the following way:
For example, if a new mutant appearing in the background of A does a partial sweep of amplitude β, the frequency of A among the fraction of strains (1−β) not concerned by the sweep will still be x, and its frequency among the fraction β of strains concerned by the sweep will be 1. Overall, this gives a frequency change of Δx=(1−x)β. A similar reasoning gives us the frequency change when the new mutant appears on the wild-type background. Finally, if no sweep occurs in the time interval dt, that is with probability 1−ρdt, x remains unchanged. The resulting frequency dynamics of mutations have many similarities to the effect of ‘genetic draft’, that is the frequency dynamics of neutral mutations due to linked selective sweeps (Gillespie, 2000).
Examples of trajectories from the random walk are shown on panel C of Figure 2, all initially starting around x0≃1/2. Two trajectories converge monotonically to 0 and 1. This is a consequence of one interesting property of Equation 9: the probability for Δx to be positive increases with x, but the magnitude of the upward steps decreases as 1−x, and symmetrically with downward steps. This leads to trajectories leading almost exponentially to 0 and 1: it can in fact be shown that trajectories that always go downwards or upwards represent a finite and relatively large fraction of all possible trajectories (see Appendix 2.4). On the other hand, steps away from the closest boundary are unlikely but much larger, resulting in ‘jack-pot’ events (Hallatschek, 2018). This can be seen in the blue trajectory in Figure 2, which oscillates for a longer time.
It is also interesting to look at the moments of the step size Δx. The first two are easily computed, and we find
The first moment being 0 means that for the random walk, increasingly probable but small steps towards the closest boundary (0 or 1) are exactly compensated by rarer but larger steps away from the boundary. Importantly, this means that on average, the trajectory of mutation A is not biased toward either fixation or loss, regardless of the frequency that the initial partial sweep brought it to. For instance, a mutation seen at frequency x0 should on average stay at this frequency, which means in practice that in a finite population, it has a chance x0 to reach 1 and fix, and a chance 1−x0 to reach 0 and vanish.
On the other hand, the second moment resembles neutral drift Kimura, 1964: in neutral evolution, allele frequency also undergoes a zero-average random walk with the second moment having the form x(1−x)/N with N being the population size. Therefore, this model would predict an ‘effective population size’ as Ne−1=ρ⟨β2⟩Pβ completely independent of the size of the viral population. However, there are important differences to neutral drift: in neutral evolution, higher moments of order k&gt;2 decay as N1−k and are thus negligible in large populations, whereas here they are independent of N and scale as ⟨βk⟩Pβ. Depending on higher moments of Pβ, allele dynamics will deviate qualitatively from neutral behavior.

Abstraction as ‘expiring’ fitness advantage
In general, the dynamics of the SIR model proposed in Equations 1&amp;2 depend on the interactions between N strains through an N×N cross-immunity matrix. While this model is useful to give a mechanistic explanation of partial sweeps, it is in general impractical to analyze and numerically simulate for many variants. The random walk model introduced above is simple to analyze and simulate, but assumes that variants rise to their equilibrium frequency instantaneously.
To explore the consequences of partial sweeps over broader parameter ranges, we propose an empirical model that has the same qualitative properties as the over-damped SIR, namely a growth rate that decreases as a strain becomes more frequent and partial sweep trajectories, but is simpler to analyze and simulate on a large scale. In this effective model, the growth rate s of the variant is not explicitly set by the susceptibility dynamics in the host population, but instead decays at a rate proportional to the frequency x of the variant:
The dynamic of x in the first equation is simply given by the usual logistic growth with fitness s. To mimic increasing immunity against the invading variant, the growth advantage s decreases proportionally to the abundance of the variant (second part of Equation 11). The initial value of s0 is connected to the invasion rate of the SIR models given in Equation 38.
The dynamics of this new model are represented in panel D of Figure 2, with an initial frequency x0≪1 and an initial growth rate s0=0.05. The initial growth of x is identical to a classical selective sweep of fitness s0 (represented as a dashed line). However, its fitness advantage gradually ‘expires,’ as shown by the red line in the figure. As the variant progressively ‘runs out of steam,’ its frequency finally saturates at a value β given by (Appendix 2.2)
This final value β depends only on the ratio between the initial fitness advantage s0 and the rate of fitness decay ν. For a large enough s0, β can be arbitrarily close to 1, meaning that this model still accommodates for full selective sweeps as a special case. In the general case, x reaches its final value β&lt;1 and remains there forever unless other variants appear.
It is important to state that the main aim of this effective model is to qualitatively reproduce the phenomenology of the SIR, and in particular the partial sweeps, while being is easier to simulate. It recapitulates the salient feature of invading immune evasive variants: (i) initial exponential growth, and (ii) eventual saturation at an intermediate frequency. We can thus use it to analyze the long-term consequences of the random walk dynamics of Figure 2. However, we do not expect the frequency of the variant x to have quantitatively equivalent dynamics in the two models. In particular, due to its simplicity, this model does not show the complex oscillatory behavior of the SIR model. Appendix 1.9 discusses in more detail the links between the parameters of the two models and the fundamental differences. While we can express the rate ν at which the growth rate declines in terms of the parameters of the simplest SIR models, for models with many groups or with oscillatory dynamics, the decay rate of the growth advantage should be interpreted as an effective parameter that captures a generic effect of reduced growth with increasing circulation.

Consequences for predictability and population dynamics
Accurate prediction of dominant viral variants of the future could improve the choice of antigens in vaccines against rapidly evolving viruses. Specifically, if a potentially adaptive mutation is observed in a viral population, one would want to know if the corresponding variants will grow in frequency, and if yes to what point? The typical traveling wave framework would predict that fast-growing variants should keep on growing until an even fitter one appears. This way of thinking about the prediction problem has shown mixed results. In the case of A/H3N2 influenza, for instance, we showed that there are few signatures that suggest fit variants grow in frequency consistently (Barrat-Charlaix et al., 2021).
In Figure 3, we reproduce some of our results of Barrat-Charlaix et al., 2021 and extend them to SARS-CoV-2. To quantify predictability, we ask the following question: given the state of a viral population at times 0,1,…,t, what can we say about variant frequencies at times t+1,…? We performed a retrospective analysis of viral evolution and identified all amino-acid mutations that were observed to grow from frequency 0 to an arbitrary threshold x⋆. Adaptive beneficial mutations should in principle be overrepresented in this group and if they provide a persistent fitness advantage, we would expect them on average to keep on growing beyond x⋆. Figure 3 shows these trajectories for the amino acid substitutions in the HA protein of A/H3N2 influenza, using data from 2000–2023,, and the SARS-CoV-2 genome using data from 2020–2023. Panels on the left show all trajectories that reached x⋆=0.4, with their average displayed in black. The panels on the right show the average trajectory for different threshold values x⋆ between 0.1 and 0.8.
Figure 3: Retrospective analysis of predictability of viral evolution: frequency trajectories of all amino acid substitutions that are observed to rise from frequency 0 to x⋆ for Top: influenza virus A/H3N2 from 2000 to 2023, and Bottom: SARS-CoV-2 from 2020 to 2023. Left: all trajectories for x⋆=0.4, with blue ones ultimately vanishing and red ones ultimately fixing. The average of all trajectories is shown as a thick black line. Right: showing only the average trajectories for different values of x⋆ (gray lines).
Figure 3—figure supplement 1: Example of mutation frequency trajectories that are increasing up to a frequency of 0.5 for H3N2/HA influenza and the expiring fitness model. For the latter, parameters used are α=s0=0.03 and three values of ρ to illustrate different clonal interference regimes. In each case, 10 randomly selected trajectories are plotted, with blue color indicating final loss and red final fixation.
While the dynamics of the variants of the two viruses can not be compared directly due to vastly different sampling intensities and different rates of adaptation, the qualitative patterns differ strikingly. In the case of influenza, trajectories of seemingly adaptive mutations show little inertia and on average hover around x⋆ instead of growing. This surprising result is in line with the study in Barrat-Charlaix et al., 2021 which used data from the period 2000–2018. On the other hand, trajectories of SARS-CoV-2 mutations show a much smoother behavior with steady growth beyond x⋆. On longer timescales, however, we observe a systematic decrease in frequency: this is explained by the particular initial dynamics of SARS-CoV-2, where new variants arose at a rapid pace and replaced old ones. This process is often called clonal interference and reduces long-term predictability.
In our setting of eco-evolutionary adaptation, the random walk model predicts that the probability of fixation of an immune evasive variant is given by the final frequency β of its initial partial sweep. Subsequent allele dynamics and diversity are governed by an anomalous coalescent process driven by the random walk defined in Equation 9, leading to little predictability of evolution. This abstraction should hold when partial sweeps are instant and do not overlap, meaning that the rate ρ at which new variants emerge is small compared to their initial growth rate s0.
To explore the behavior of our partial sweep model in a more general setting, we simulate the evolutionary dynamics of a population under a Wright-Fisher model with expiring fitness dynamics. Simulations involve a population of N viruses with a genotype where each position can be in one of two possible states σi∈{0,1}. Fitness effects si are associated with mutations at each position, and the total fitness of a virus is given by F=∑iσisi. At each generation, viruses with a fitness F expand by a factor eF, and the next generation is constructed by sampling N individuals from the previous one. Following Equation 11, mutational effects si decrease by an amount νxi⋅si, where xi is the frequency at which mutation i is found in the population.
We simulate the emergence of adaptive variants in the following way. At a constant rate ρ, we pick one sequence position i that has no polymorphism and set the fitness effect of the corresponding mutation to an initial value si, with an amplitude drawn from probability distribution Ps and the sign chosen such that the mutation is adaptive. In practice, we use an exponential distribution Ps∝e−s/s0, meaning that the typical magnitude of initial fitness effects are described by only one parameter s0. The corresponding distribution of partial sweep size is described Appendix 2.3. At the same time, we introduce the corresponding mutant in the population at a low frequency, picking its background genotype from a random existing strain. The behavior of the model is determined by (i) the distribution Pβ of partial sweeps size depending on ν/s0, and (ii) the ratio of the variant emergence rate and their growth rate ρ/s0, which determines how often sweeps overlap and interact. The probability of two sweeps overlapping is defined in Appendix 2, Equation 42.
We use this simulation to address the question of predictability: given the state of the population at generations 0,1,…,t, can we predict its state at future times t+1,…? Specifically, we ask whether we can predict the frequency x(t+Δt) of a variant A, given it is at frequency x at time t, as we did previously for the influenza virus Barrat-Charlaix et al., 2021, see Figure 3. The dynamics of isolated selective sweeps (ρ/s0≪1, ν/s0≪1) should be perfectly predictable: after an initial stochastic phase when the variant is very rare, its frequency grows monotonically to fixation. This predictability decreases with increasing ρ/s0 due to clonal interference (Schiffels et al., 2011; Strelkowa and Lässig, 2012), for example when an adaptive variant is outcompeted by an even more adaptive one. We also expects predictability to decrease with increasing ν/s0 since sweeps are then partial and their ultimate fixation is determined by subsequent variants with dynamics that resemble a random walk.
To quantify these effects, we select from a long simulation all rising frequency trajectories of adaptive mutations that cross an arbitrary threshold x∗. The results are shown in panel A of Figure 4, where we show the average x(t) of rising frequency trajectories after crossing the threshold x∗=0.5. We use three rates of fitness decay: ν∈[0,s0/3,s0,3s0] and low clonal interference ρ/s0=0.05. The case ν=0 corresponds to a classical traveling wave scenario with constant fitness effects, and, as expected, is the most predictable: the average trajectory rises well above 0.5. For larger values of ν/s0, corresponding to a quicker decay of fitness, predictability gradually declines and becomes negligible for ν/s≫1. Note that this matches quite well with the predictions from the random walk model where the average change in frequency ⟨Δx⟩ is null.
Figure 4: Simulations under the Wright-Fisher model with expiring fitness. (A) Average frequency dynamics of immune escape mutations that are found to cross the frequency threshold x∗=0.5, for four different rates of fitness decay. If the growth advantage is lost rapidly (high ν/s0), the trajectories crossing x∗ have little inertia, while stable growth advantage (small ν/s0) leads to steadily increasing frequencies. (B, C, D) Ultimate probability of pfix(x) of trajectories found crossing frequency threshold x. Each panel corresponds to a different rate of emergence of immune escape variants, with four rates of fitness decay per panel. Increased clonal interference ρ/s0 and fitness decay ν/s0 both result in a gradual loss of predictability. We use s0=0.03. (E) Time to most recent common ancestor TMRCA for the simulated population, as a function of the prediction obtained using the random walk Ne=1/ρ⟨β2⟩. Points correspond to different choices of parameters ρ and Pβ, and a darker color indicates a higher probability of overlap as computed in Appendix 2.2.
Figure 4—figure supplement 1: Probability of fixation of mutation Probability of fixation of mutations pfix(x) of mutation frequency trajectories found crossing the frequency threshold x. Fitness effects are exponentially distributed with fixed scale s0=0.03. The blue to red gradient in colors corresponds to the increasing rate ρ at which mutations are introduced. Strong clonal interference regime is obtained when ρ/s0&gt;1, in which case good mutations are introduced in close succession and compete for fixation. At low ρ/s0, trajectories are very predictable and an increasing trajectory almost certainly fixes. Even for the highest ρ/s0, pfix(x) remains significantly larger than x and dynamics are visibly not neutral.
To explore parameter space more systematically, we quantify predictability as the probability of fixation pfix of rising variants that cross threshold x∗. In a perfectly predictable scenario with well-separated selective sweeps, pfix should be close to 1 regardless of x∗, while it should be equal to x∗ in an unpredictable setting such as neutral evolution.
In panels B, C, and D of Figure 4, the probability of fixations are shown for three values of ρ/s0 and four values of ν/s0. Clonal interference increases when going from left to right among these panels (increasing ρ/s0), while the intensity of fitness decay increases when going from blue to red curves (increasing ν). Increasing either ρ/s0 or ν/s0 reduces pfix towards the dashed diagonal corresponding to pfix=x∗. However, as observed previously (Barrat-Charlaix et al., 2021), in the classic scenario with stable fitness effects ν/s0=0 considerable predictability remains even in cases of strong interference (blue curve in panel D and Figure 4—figure supplement 1). The strong interference setting is explored in more detail in Appendix 2.1 up to values ρ/s0≃30, using similar simulations but without expiring fitness ν=0. Figure 4—figure supplement 1 shows that even in these cases of strong interference, pfix remains significantly above the diagonal.
Finally, we use our simulation to investigate typical levels of diversity in the population and the time to the most recent common ancestor. One quantity that can easily be estimated from the random walk model is the average pairwise coalescence time T2, that is the typical times separating two random strains from their most recent common ancestor (MRCA). In Appendix 2.5, we show that under the random walk approximation T2=1/ρ⟨β2⟩Pβ, which in neutral models of evolution would correspond to the effective population size Ne. A more detailed analysis of the coalescent process reveals that the random walk approximation corresponds to the so-called Λ-coalescent Schweinsberg, 2000; Berestycki, 2009.
In panel E of Figure 4, the average time to the common ancestor of pairs of strains in the population is plotted as a function of T2 predicted by the random walk model. Each point in the figure corresponds to one simulation of long duration with a given distribution of partial sweep size Pβ and a given ρ setting T2, with darker color indicating a higher probability of overlap as computed in Appendix 2.2. We find a good agreement between the empirical time to MRCA and the estimation from the random walk, at least as long as the probability of overlap between successive partial sweeps is small (indicated by shading). With increasing overlaps, coalescence slows down, and diversity increases: points in darker shades of red tend to have a larger time to MRCA than what is expected from the distribution of β. This is expected intuitively: if another adaptive variant emerges before the previous one has reached its final frequency, it has a lower probability of landing on the same background and thus tends to be in competition with the first variant. This leads to a smaller effective β which slows the dynamics.


DISCUSSION
Evolutionary adaptation is often pictured as an optimization problem in a static environment. In many cases, however, this environment is changed by the presence of the evolving species, for example, because a host population develops immunity or a dynamic ecology. Here, we have explored the consequences of such eco-evolutionary dynamics in a case of host-pathogen co-evolution where different variants of a pathogen shape each other’s environment through generation of cross-immunity.
Influenza virus evolution has been the subject of intense research with efforts to predict the composition of future viral populations (Bush et al., 1999; Luksza and Lässig, 2014; Neher et al., 2014; Huddleston et al., 2020). The A/H3N2 subtype in particular undergoes rapid antigenic change through frequent substitutions in prominent epitopes on its surface proteins (Smith et al., 2004; Bhatt et al., 2011; Neher et al., 2016; Kistler and Bedford, 2023). Given the clear signal of adaptive evolution, one might expect A/H3N2 to be predictable in the sense that variants that grow keep growing. Yet, it has been difficult to find convincing signals of fit, antigenically novel, variants that consistently grow and replace their competitors (Barrat-Charlaix et al., 2021; Huddleston et al., 2020). In contrast, SARS-CoV-2 evolution has been consistently predictable in the sense that dynamics are well modeled by exponentially growing variants that compete for a common pool of susceptible hosts. However, even in this case, taking into account the immune adaptation of hosts leads to a better description of variant dynamics Meijers et al., 2023.
We have shown that depending on (i) the heterogeneity of immunity in the population, (ii) the asymmetry between backward and forward cross-immune recognition, and (iii) waning or turn-over of immunity, the immune escape can either lead to dynamics dominated by selective sweeps, or to one were escape mutations have an initial growth advantage that dissipates before the variant fixes. The former scenario is observed when initial growth is fast, backward immunity high, and waning slow compared to variant dynamics. In this case, new variants can rise to high frequency driven by their own advantage and fix. Immunological heterogeneity slows down the initial rise, allowing for population immunity to respond and adjust before the variant has been fixed.
This process of partial sweeps reconciles two seemingly contradicting observations: HA evolution in human influenza A virus is clearly driven by adaptive immune escape and most substitutions are clustered in epitope regions (Bhatt et al., 2013). On the other hand, most substitutions does not sweep to fixation but tends to meander in a quasi-neutral fashion (Barrat-Charlaix et al., 2021). In the partial sweep scenario proposed here, diversity is dominated by immune escape mutations that are rapidly brought to macroscopic frequency by their initial growth advantage, but their ultimate fate is determined mostly by subsequent mutations.
In any real-world scenario, there will be a variety of mutations, including some mutations that perform complete selective sweeps, either because they escape immunity of a large fraction of the population (M small), because they generate robust immunity against previous strains (‘back-boost’ Fonville et al., 2014), or because of the increase in the intrinsic transmissibility of the virus (for example reverting a previous escape mutation that had a deleterious effect on transmissibility). The degree to which partial sweeps matter will vary from virus to virus and will change over time. Recently emerged viruses circulate in a homogeneous immune landscape and adapt to the new host for some time, consistent with rapid and complete sweeps of variants in SARS-CoV-2. Similarly, the influenza virus A/H1N1pdm, which emerged in humans in 2009, exhibited more consistent trajectory dynamics than A/H3N2 (Barrat-Charlaix et al., 2021).
More generally, qualitative features of the partial sweep dynamics investigated here are expected to exist in any system where the environment responds to evolutionary changes on time scales comparable to the time it takes for the adaptive variants to take over, leading to eco-evolutionary dynamics (Pelletier et al., 2009). In ecological systems involving eukaryotes, it is the evolutionary part of this interaction that is thought of as slow, while ecology is fast. In the cases of rapidly adapting RNA viruses in human populations with long-lived immunological memory, models often assume that viral adaptation is fast while hosts have long-lasting memory. The most complex and least predictable dynamics are expected when the evolutionary and ecological time scales are similar and different host-pathogen systems will fall on different points along this axis.

MATERIALS AND METHODS
Code availability


Data availability
Sequence data of influenza viruses was obtained from GISAID (Shu and McCauley, 2017). We thank the teams involved in sample collection, sequencing, and processing of these data for their contribution to global surveillance of influenza virus circulation. A table acknowledging all originating and submitting laboratories is provided as supplementary information.
Sequence data of SARS-CoV-2 viruses was obtained from NCBI and restricted to data from North America to ensure more homogeneous sampling. We are grateful to all teams involved in the collection and generation of these data for generously sharing these data openly.
