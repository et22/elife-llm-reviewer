TITLE
Intraspecific predator interference promotes biodiversity in ecosystems

ABSTRACT
Explaining biodiversity is a fundamental issue in ecology. A long-standing puzzle lies in the paradox of the plankton: many species of plankton feeding on a limited variety of resources coexist, apparently flouting the competitive exclusion principle (CEP), which holds that the number of predator (consumer) species cannot exceed that of the resources at a steady state. Here, we present a mechanistic model and demonstrate that intraspecific interference among the consumers enables a plethora of consumer species to coexist at constant population densities with only one or a handful of resource species. This facilitated biodiversity is resistant to stochasticity, either with the stochastic simulation algorithm or individual-based modeling. Our model naturally explains the classical experiments that invalidate the CEP, quantitatively illustrates the universal S-shaped pattern of the rank-abundance curves across a wide range of ecological communities, and can be broadly used to resolve the mystery of biodiversity in many natural ecosystems.

INTRODUCTION
The most prominent feature of life on Earth is its remarkable species diversity: countless macro- and micro-species fill every corner on land and in the water (Pennisi, 2005; Hoorn et al., 2010; de Vargas et al., 2015; Daniel, 2005). In tropical forests, thousands of plant and vertebrate species coexist (Hoorn et al., 2010). Within a gram of soil, the number of microbial species is estimated to be 2000–18,000 (Daniel, 2005). In the photic zone of the world ocean, there are roughly 150,000 eukaryotic plankton species (de Vargas et al., 2015). Explaining this astonishing biodiversity is a major focus in ecology (Pennisi, 2005). A great challenge stems from the well-known competitive exclusion principle (CEP): two species competing for a single type of resources cannot coexist at constant population densities (Gause, 1934; Hardin, 1960), or generically, in the framework of consumer-resource models, the number of consumer species cannot exceed that of resources at a steady state (MacArthur and Levins, 1964; Levin, 1970; McGehee, 1977). On the contrary, in the paradox of plankton, a limited variety of resources supports hundreds or more coexisting species of phytoplankton (Hutchinson, 1961). Then, how can plankton and many other organisms somehow liberate the constraint of CEP?
Ever since MacArthur and Levin proposed the classical mathematical proof for CEP in the 1960s (MacArthur and Levins, 1964), various mechanisms have been put forward to overcome the limits set by CEP (Chesson, 2000). Some suggest that the system never approaches a steady state where the CEP applies, due to temporal variations (Hutchinson, 1961; Levins, 1979), spatial heterogeneity (Levin, 1974), or species’ self-organized dynamics (Koch, 1974; Huisman and Weissing, 1999). Others consider factors such as toxins (Czárán et al., 2002), cross-feeding (Goyal and Maslov, 2018; Goldford et al., 2018; Niehaus et al., 2019), spatial circulation (Villa Martín et al., 2020; Gupta et al., 2021), ‘kill the winner’ (Thingstad, 2000), pack hunting (Wang and Liu, 2020), collective behavior (Dalziel et al., 2021), metabolic trade-offs (Posfai et al., 2017; Weiner et al., 2019), co-evolution (Xue and Goldenfeld, 2017), and other complex interactions among the species (Beddington, 1975; DeAngelis et al., 1975; Arditi and Ginzburg, 1989; Kelsic et al., 2015; Grilli et al., 2017; Ratzke et al., 2020). However, questions remain as to what determines species diversity in nature, especially for quasi-well-mixed systems such as that of plankton (Pennisi, 2005; Sunagawa et al., 2020).
Among the proposed mechanisms, predator interference, specifically the pairwise encounters among consumer individuals, emerges as a potential solution to this issue. Predator interference is commonly described by the classical Beddington-DeAngelis (B-D) phenomenological model (Beddington, 1975; DeAngelis et al., 1975). Through the application of the B-D model, several studies (Cantrell et al., 2004; Hsu et al., 2013) have shown that intraspecific predator interference can break CEP and facilitate species coexistence. However, from a mechanistic perspective, the functional response of the B-D model can be formally derived from a scenario solely involving chasing pairs, representing the consumption process between consumers and resources, without accounting for pairwise encounters among consumer individuals (Wang and Liu, 2020; Huisman and De Boer, 1997). Disturbingly, it has been established that the scenario involving only chasing pairs is subject to the constraint of CEP (Wang and Liu, 2020), raising doubt regarding the validity of applying the B-D model to overcome the CEP.
In this work, building upon MacArthur’s consumer-resource model framework (Arthur, 1969; MacArthur, 1970; Chesson, 1990), and drawing on concepts from chemical reaction kinetics (Ruxton et al., 1992; Huisman and De Boer, 1997; Wang and Liu, 2020), we present a mechanistic model of predator interference that extends the B-D phenomenological model (Beddington, 1975; DeAngelis et al., 1975) by providing a detailed consideration of pairwise encounters. The intraspecific interference among consumer individuals effectively constitutes a negative feedback loop, enabling a wide range of consumer species to coexist with only one or a few types of resources. The coexistence state is resistant to stochasticity and can hence be realized in practice. Our model is broadly applicable and can be used to explain biodiversity in many ecosystems. In particular, it naturally explains species coexistence in classical experiments that invalidate CEP (Ayala, 1969; Park, 1954) and quantitatively illustrates the S-shaped pattern of the rank-abundance curves in an extensive spectrum of ecological communities, ranging from the communities of ocean plankton worldwide (Fuhrman et al., 2008; Ser-Giacomi et al., 2018), tropical river fishes from Argentina (Cody and Smallwood, 1996), forest bats of Trinidad (Clarke et al., 2005), rainforest trees (Hubbell, 2001), birds (Terborgh et al., 1990; Martínez et al., 2023), butterflies (De Vries, 1997) in Amazonia, to those of desert bees (Hubbell, 2001) in Utah and lizards from South Australia (Cody and Smallwood, 1996).

RESULTS
A generic model of pairwise encounters
Here we present a mechanistic model of pairwise encounters (see Figure 1A), where SC consumer species {C1,⋯,CSC} compete for SR resource species {R1,⋯,RSR}. The consumers are biotic, while the resources can be either biotic or abiotic. For simplicity, we assume that all species are motile and move at certain speeds, namely, vCi for consumer species Ci and vRl for resource species Rl. For abiotic resources, they cannot propel themselves but may passively drift due to environmental factors. Each consumer is free to feed on one or multiple types of resources, while consumers do not directly interact with one another except through pairwise encounters.
Figure 1: A model of pairwise encounters may naturally break CEP. (A) A generic model of pairwise encounters involving SC consumer species and SR resource species. (B) The well-mixed model of (A). (C–E) Time courses of two consumer species competing for one resource species. (F–H) Positive solutions to the steady-state equations (see Equations S38 and S65): R˙=0 (orange surface), C˙1=0 (blue surface), C˙2=0 (green surface), that is the zero-growth isoclines. The black/red dot represents the unstable/stable fixed point, while the dotted lines in (E) are the analytical solutions of the steady-state abundances (marked with superscript ‘(A)’). See Appendix 1—tables 1 and 2 for the definitions of symbols. See Appendix 9 for simulation details.
Then, we explicitly consider the population structure of consumers and resources: some wander around freely, undergoing Brownian motions; others encounter one another, forming ephemeral entangled pairs. Specifically, when a consumer individual Ci and a resource Rl come close within a distance of ril(C) (see Figure 1A), the consumer can chase the resource and form a chasing pair: Ci(P)⋁Rl(P) (see Figure 1B), where the superscript ‘(P)’ represents ‘pair’. The resource can either escape at rate dil or be caught and consumed by the consumer with rate kil. Meanwhile, when a Ci individual encounters another consumer Cj within a distance of rij(I) (see Figure 1A), they can stare at, fight against, or play with each other, thus forming an interference pair: Ci(P)⋁Cj(P) (see Figure 1B). This paired state is evanescent, with consumers separating at rate dij′. For simplicity, we assume that all ril(C) and rij(I) are identical, respectively, that is ∀i,j,l, ril(C)=r(C) and rij(I)=r(I).
In a well-mixed system of size L2, the encounter rates among individuals, ail and aij′ (see Figure 1B), can be derived using the mean-field approximation: ail=2r(C)L−2vCi2+vRl2 and aij′=2r(I)L−2vCi2+vCj2 (see Materials and methods, and Appendix 1—figure 1). Then, we proceed to analyze scenarios involving different types of pairwise encounters (see Figure 1B). For the scenario involving only chasing pairs, the population dynamics can be described as follows:
where xil≡Ci(P)⋁Rl(P), gl is an unspecified function, the superscript ‘(F)’ represents the freely wandering population, Di denotes the mortality rate of Ci, and wil is the mass conversion ratio (Wang and Liu, 2020) from resource Rl to consumer Ci. With the integration of intraspecific predator interference, we combine Equation 1 and the following equation:
where ai′=aii′, di′=dii′, and yi≡Ci(P)⋁Ci(P) represents the intraspecific interference pair (see Figure 1B). For the scenario involving chasing pairs and interspecific interference, we combine Equation 1 with the following equation:
where zij≡Ci(P)⋁Cj(P) stands for the interspecific interference pair (see Figure 1B). In the scenario where chasing pairs and both intra- and interspecific interference are relevant, we combine Equations 1–3, and the populations of consumers and resources are given by Ci=Ci(F)+∑lxil+2yi+∑j≠izij and Rl=Rl(F)+∑ixil, respectively.
Generically, the consumption and interference processes are much quicker compared to the birth and death processes. Thus, in the derivation of the functional response, F(Rl,Ci)≡kilxil/Ci, the consumption and interference processes are supposed to be in fast equilibrium. In all scenarios involving different types of pairwise encounters, the functional response in the B-D model is a good approximation only for a special case with dil≈0 and Rl≫∑i=1SCCi (see Appendix 1—figure 2 and Appendix 3 for details).
To facilitate further analysis, we assume that the population dynamics of the resources follows the same construction rule as that in MacArthur’s consumer-resource model (Arthur, 1969; MacArthur, 1970; Chesson, 1990). Then,
In the absence of consumers, biotic resources exhibit logistic growth. Here, ηl and κl represent the intrinsic growth rate and the carrying capacity of species Rl. For abiotic resources, ζl stands for the external resource supply rate of Rl, and κl is the abundance of Rl at a steady state without consumers. For simplicity, we focus our analysis on abiotic resources, although all results generally apply to biotic resources as well. By applying dimensional analysis, we render all parameters dimensionless (see Appendix 7). For convenience, we retain the same notations below, with all parameters considered dimensionless unless otherwise specified.

Intraspecific predator interference facilitates species coexistence and breaks CEP
To clarify the specific mechanisms that can facilitate species coexistence, we systematically investigate scenarios involving different forms of pairwise encounters in a simple case with SC=2 and SR=1. To simplify the notations, we omit the subscript/superscript ‘l’ since SR=1. For clarity, we assign each consumer species of unique competitiveness by setting that the mortality rate Di is the only parameter that varies with the consumer species.
First, we conduct the analysis within a deterministic framework using ordinary differential equations (ODEs). In the scenario involving only chasing pairs, consumer species cannot coexist at a steady state except for special parameter settings (sets of measure zero) (Wang and Liu, 2020). In practice, if all species coexist, the steady-state equations of the consumer species (C˙i=0, i.e. the zero-growth isolines) yield fi(R(F))=Di (i=1,2), where fi(R(F)) is defined as fi(R(F))≡R(F)/(R(F)+Ki) and Ki≡(di+ki)/ai. These equations form two parallel surfaces in the (C1,C2,R) coordinates, making steady coexistence impossible (Wang and Liu, 2020; see Figure 1C and F and Appendix 1—figure 3A–C).
Meanwhile, in the scenario involving chasing pairs and interspecific interference, if all species coexist, the zero-growth isolines of the three species (see Equation S65) correspond to three non-parallel surfaces Ωi′(R,C1,C2)=Di (i=1,2), G′(R,C1,C2)=0 (see Figure 1G and Appendix 1—figure 3D; refer to Appendix 5 for definitions of Ωi′ and G′), which can intersect at a common point (fixed point). However, this fixed point is unstable (see Figure 1G and Appendix 1—figure 3D, F), and thus one of the consumer species is doomed to extinction (see Figure 1D).
Next, we turn to the scenario involving chasing pairs and intraspecific interference. Likewise, steady coexistence requires (see Equation S38) that three non-parallel surfaces Ωi(R,C1,C2)=Di (i=1,2), G(R,C1,C2)=0 cross at a common point (see Figure 1H and Appendix 1—figure 3G; refer to Appendix 4 for definitions of Ωi and G). Indeed, this naturally happens, and encouragingly the fixed point can be stable. Therefore, two consumer species may stably coexist at a steady state with only one type of resources, which obviously breaks CEP (see Figure 1E and Appendix 1—figure 4A). In fact, the coexisting state is globally attractive (see Appendix 1—figure 4A), and there exists a non-zero volume of parameter space where the two consumer species stably coexist at constant population densities (see Appendix 1—figure 4B, C), demonstrating that the violation of CEP does not depend on special parameter settings. We further consider the scenario involving chasing pairs and both intra- and interspecific interference (see Appendix 1—figure 5). Much as expected, the species coexistence behavior is very similar to that without interspecific interference.

Intraspecific interference promotes biodiversity in the presence of stochasticity
Stochasticity is ubiquitous in nature. However, it is prone to jeopardize species coexistence (Xue and Goldenfeld, 2017). Influential mechanisms such as ‘kill the winner’ fail when stochasticity is incorporated (Xue and Goldenfeld, 2017). Consistent with this, we observe that two notable cases of oscillating coexistence (Koch, 1974; Huisman and Weissing, 1999) turn into species extinction when stochasticity is introduced (see Appendix 1—figure 6A, B), where we simulate the models with stochastic simulation algorithm (SSA; Gillespie, 2007) and adopt the same parameters as those in the original references (Koch, 1974; Huisman and Weissing, 1999).
Then, we proceed to investigate the impact of stochasticity on our model using SSA (Gillespie, 2007). In the scenario involving chasing pairs and intraspecific interference, species may coexist indefinitely in the SSA simulations (see Figure 2A and Appendix 1—figure 4D). In fact, the parameter region for species coexistence in this scenario is rather similar between the SSA and ODEs studies (see Appendix 1—figure 6C, D). Similarly, in the scenario involving chasing pairs and both inter- and intraspecific interference, all species may coexist indefinitely in company with stochasticity (see Appendix 1—figure 5D).
Figure 2: Intraspecific predator interference facilitates species coexistence regardless of stochasticity. (A, B) Time courses of the species abundances simulated with ODEs, SSA, or IBM. (C) Snapshots of the IBM simulations. (D, E) A model of intraspecific predator interference explains two classical laboratory experiments that invalidate CEP. (D) In Ayala’s experiment, two Drosophila species coexist with one type of resources within a laboratory bottle (Ayala, 1969). (E) In Park’s experiment, two Tribolium species coexist for 2 years with one type of food (flour) within a lab (Park, 1954). See Appendix 1—figure 7C, D for the comparison between model results and experimental data using Shannon entropies.
To further mimic a real ecosystem, we resort to individual-based modeling (IBM; Grimm, 2013; Vetsigian, 2017), an essentially stochastic simulation method. In the simple case of SC=2 and SR=1, we simulate the time evolution of a 2-D square system in a size of L2 with periodic boundary conditions (see Materials and methods for details). In the scenario involving chasing pairs and intraspecific interference, two consumer species coexist for long with only one type of resources in the IBM simulations (see Figure 2B and C). Together with the SSA simulation studies, it is obvious that intraspecific interference still robustly promotes species coexistence when stochasticity is considered.

Comparison with experimental studies that reject CEP
In practice, two classical studies (Ayala, 1969; Park, 1954) reported that, in their respective laboratory systems, two species of insects coexisted for roughly years or more with only one type of resources. Evidently, these two experiments (Ayala, 1969; Park, 1954) are incompatible with CEP, while factors such as temporal variations, spatial heterogeneity, cross-feeding, etc. are clearly not involved in such systems. As intraspecific fighting is prevalent among insects (Boomsma et al., 2005; Dankert et al., 2009; Chen et al., 2002), we apply the model involving chasing pairs and intraspecific interference to simulate the two systems. Overall, our SSA results show good consistency with those of the experiments (see Figure 2D and E and Appendix 1—figure 7). The fluctuations in experimental time series can be mainly accounted by stochasticity.

A handful of resource species can support a wide range of consumer species regardless of stochasticity
To resolve the puzzle stated in the paradox of the plankton, we analyze the generic case where SC consumer species compete for SR resource species (with SC&gt;SR) within the scenario involving chasing pairs and intraspecific interference. The population dynamics is described by equations combining Equations 1, 2 and 4. As with the cases above, each consumer species is assigned a unique competitiveness through a distinctive Di.
Strikingly, a plethora of consumer species may coexist at a steady state with only one resource species (SC≫SR, SR=1) in the ODEs simulations, and crucially, the facilitated biodiversity can still be maintained in the SSA simulations. The long-term coexistence behavior is exemplified in Figure 3 and Appendix 1—figures 8–10, involving simulations with or without stochasticity. The number of consumer species in long-term coexistence can be up to hundreds or more (see Figure 3 and Appendix 1—figure 8). To mimic real ecosystems, we further analyze cases with more than one type of resources, such as systems with SR=3 (SC≫SR). Just like the case of SR=1 (SC≫SR), an extensive range of consumer species may coexist indefinitely regardless of stochasticity (see Figure 3 and Appendix 1—figures 11–14).
Figure 3: Intraspecific interference enables a wide range of consumer species to coexist with only one or a handful of resource species. (A, B) Representative time courses simulated with ODEs and SSA. (C, D) A model of intraspecific predator interference illustrates the S-shaped pattern of the species’ rank-abundance curves across different ecological communities. The solid icons represent the experimental data (marked with ‘Exp’) reported in existing studies (Fuhrman et al., 2008; Cody and Smallwood, 1996; Terborgh et al., 1990; Martínez et al., 2023; Clarke et al., 2005; De Vries, 1997; Hubbell, 2001), where the bird community data were collected longitudinally in 1982 and 2018 (Terborgh et al., 1990; Martínez et al., 2023). The ODEs and SSA results were constructed from timestamp t=1.0×105 in the time series. In the K-S test, the probabilities (p-values) that the simulation results and the corresponding experimental data come from the same distributions are: pODEsbird(1982)=0.17, pODEsbird(2018)=0.26, pODEsbutterfly=0.70, pODEsfish=0.88, pODEsbat=0.42, pSSAbat=0.48, pODEslizard=0.96, pSSAlizard=0.54, pODEsplankton=0.20, pSSAplankton=0.06. See Appendix 9 for simulation details and the Shannon entropies.
We further analyze the scenario involving chasing pairs and both intra- and interspecific interference, where multiple consumer species compete for one resource species. Similar to the scenario involving chasing pairs and intraspecific interference, all species coexist indefinitely in either ODEs or SSA simulation studies (see Appendix 1—figure 5F–H for the cases of SC=6,20 and SR=1).

Intuitive understanding: an underlying negative feedback loop
For the case with only one resource species (SR=1), if the total population size of the resources is much larger than that of the consumers (i.e. R≫∑i=1SCCi), the functional response F≡kixi/Ci and the steady-state population of each consumer and resource species can be obtained analytically (see Appendix 4.B-C for details). In fact, the functional response of a consumer species (e.g. Ci) is negatively correlated with its own population size:
where βi≡ai′/di′. The analytical steady-state solutions are highly consistent with the numerical results (see Figure 1E and Appendix 1—figure 3H, I) and can even quantitatively predict the coexistence region of the parameter space (see Appendix 1—figure 3I).
Intuitively, the mechanisms of how intraspecific interference facilitates species coexistence can be understood from the underlying negative feedback loop. Specifically, for consumer species of higher competitiveness (e.g. Ci) in an ecological community, as the population size of Ci increases during competition, a larger portion of Ci individuals are then engaged in intraspecific interference pairs which are temporarily absent from hunting (see Equation S59 and Appendix 1—figure 15A, B). Consequently, the fraction of Ci individuals within chasing pairs decreases (see Equation S59 and Appendix 1—figure 15A, B) and thus form a self-inhibiting negative feedback loop through the functional response (see Equation 5 and Appendix 1—figure 15C). This negative feedback loop prevents further increases in Ci populations, results in an overall balance among the consumer species, and thus promotes biodiversity (see Appendix 4.C for details).

The S shape pattern of the rank-abundance curves in a broad range of ecological communities
As mentioned above, a prominent feature of biodiversity is that the species’ rank-abundance curves follow a universal S-shaped pattern in the linear-log plot across a broad spectrum of ecological communities (Fuhrman et al., 2008; Ser-Giacomi et al., 2018; Cody and Smallwood, 1996; Terborgh et al., 1990; Martínez et al., 2023; Clarke et al., 2005; Hubbell, 2001; De Vries, 1997). Previously, this pattern was mostly explained by the neutral theory (Hubbell, 2001), which requires special parameter settings that all consumer species share identical fitness. To resolve this issue, we apply the model involving chasing pairs and intraspecific interference to simulate the ecological communities, where one or three types of resources support a large number of consumer species (SC≫SR). In each model system, the mortality rates of consumer species follow a Gaussian distribution where the coefficient of variation was taken around 0.3 (Menon et al., 2003; see Appendix 9 for details). For a broad array of the ecological communities, the rank-abundance curves obtained from the long-term coexisting state of both the ODEs and SSA simulation studies agree quantitatively with those of experiments (see Figure 3C and D and Appendix 1—figures 8–14), sharing roughly equal Shannon entropies and mostly being regarded as identical distributions in the Kolmogorov-Smirnov (K-S) statistical test (with a significance threshold of 0.05). Still, there is a noticeable discrepancy between the experimental data and SSA studies in terms of the species’ absolute abundances (e.g. see Appendix 1—figure 8C): those with experimental abundances less than 10 tend to be extinct in the SSA simulations. This is due to the fact that the recorded individuals in an experimental sample are just a tiny portion of that in the real ecological system, whereas the species population size in a natural community is certainly much larger than 10.


DISCUSSION
The conflict between the CEP and biodiversity, exemplified by the paradox of the plankton (Hutchinson, 1961), is a long-standing puzzle in ecology. Although many mechanisms have been proposed to overcome the limit set by CEP (Hutchinson, 1961; Chesson, 2000; Levins, 1979; Levin, 1974; Koch, 1974; Huisman and Weissing, 1999; Czárán et al., 2002; Goyal and Maslov, 2018; Goldford et al., 2018; Villa Martín et al., 2020; Gupta et al., 2021; Thingstad, 2000; Wang and Liu, 2020; Dalziel et al., 2021; Posfai et al., 2017; Weiner et al., 2019; Xue and Goldenfeld, 2017; Beddington, 1975; DeAngelis et al., 1975; Arditi and Ginzburg, 1989; Kelsic et al., 2015; Grilli et al., 2017; Ratzke et al., 2020), it is still unclear how plankton and many other organisms can flout CEP and maintain biodiversity in quasi-well-mixed natural ecosystems. To address this issue, we investigate a mechanistic model with detailed consideration of pairwise encounters. Using numerical simulations combined with mathematical analysis, we identify that the intraspecific interference among the consumer individuals can promote a wide range of consumer species to coexist indefinitely with only one or a handful of resource species through the underlying negative feedback loop. By applying the above analysis to real ecological systems, our model naturally explains two classical experiments that reject CEP (Ayala, 1969; Park, 1954), and quantitatively illustrates the universal S-shaped pattern of the rank-abundance curves for a broad range of ecological communities (Fuhrman et al., 2008; Ser-Giacomi et al., 2018; Cody and Smallwood, 1996; Terborgh et al., 1990; Martínez et al., 2023; Clarke et al., 2005; Hubbell, 2001; De Vries, 1997).
In fact, predator interference has been introduced long ago by the classical B-D phenomenological model (Beddington, 1975; DeAngelis et al., 1975). However, the functional response of the B-D model involving intraspecific interference can be formally derived from the scenario involving only chasing pairs without consideration of pairwise encounters between consumer individuals (Wang and Liu, 2020; Huisman and De Boer, 1997; see Equations S8a and S24a). Yet, it has been demonstrated that the scenario involving only chasing pairs is under the constraint of CEP (Wang and Liu, 2020; see Appendix 1—figure 3A–C). Therefore, it is questionable regarding the validity of applying the B-D model to break CEP (Cantrell et al., 2004; Hsu et al., 2013). From a mechanistic perspective, we resolve these issues and show that the B-D model corresponds to a special case of our mechanistic model yet without the escape rate (see Appendix 1—figure 2 and Appendix 3 for details).
Our model is broadly applicable to explain biodiversity in many ecosystems. In practice, many more factors are potentially involved, and special attention is required to disentangle confounding factors. In microbial systems, complex interactions are commonly involved (Goyal and Maslov, 2018; Goldford et al., 2018; Hu et al., 2022), and species’ preference for food is shaped by the evolutionary course and environmental history (Wang et al., 2019). It is still highly challenging to fully explain how organisms evolve and maintain biodiversity in diverse ecosystems.

MATERIALS AND METHODS
Derivation of the encounter rates with the mean-field approximation
In the model depicted in Figure 1A, consumers and resources move randomly in space, which can be regarded as Brownian motions. At moment t, a consumer individual of species Ci moves at speed vCi with velocity vCi(t), while a resource individual of species Rl moves at speed vRl with velocity vRl(t). Here, vCi and vRl are two invariants, while the directions of vCi(t) and vRl(t) change constantly. The relative velocity between the two individuals is uCi−Rl(t)≡vRl(t)−vCi(t), with a relative speed of uCi−Rl(t). Then, uCi−Rl(t)2=vCi2+vRl2−2vCi⋅vRl⋅cos⁡θCi−Rl(t), where θCi−Rl(t) represents the angle between vCi(t) and vRl(t). This system is homogeneous, thus, cos⁡θCi−Rl¯=0, where the overline stands for the temporal average. Then, we obtain the average relative speed between the Ci and Rl individuals: uCi−Rl¯=vCi2+vRl2. Likewise, the average relative speed between the Ci and Cj individuals is uCi−Cj¯=vCi2+vCj2. Evidently, uCi−Ci¯=2vCi. Meanwhile, the concentrations of species Ci and Rl in a 2-D square system with a length of L are nCi=Ci/L2 and nRl=Rl/L2, while those of the freely wandering Ci and Rl are nCi(F)=Ci(F)/L2 and nRl(F)=Rl(F)/L2.
Then, we use the mean-field approximation to calculate the encounter rates ail and aij′ in the well-mixed system. In particular, we estimate ail by tracking a randomly chosen consumer individual from species Ci and counting its encounter frequency with the freely wandering individuals from resource species Rl (see Appendix 1—figure 1). At any moment, the consumer individual may form a chasing pair with a Rl individual within a radius of ril(C) (see Figure 1A). Over a time interval of Δt, the number of encounters between the consumer individual and Rl individuals can be estimated by the encounter area and the concentration nRl, which takes the value of 2ril(C)nR(F)uCi−R¯Δt (see Appendix 1—figure 1). Combined with nRl(F)=Rl(F)/L2, for all freely wandering Ci individuals, the number of their encounters with R(F) during interval Δt is 2ril(C)uCi−R¯Ci(F)R(F)L2Δt. Meanwhile, in the ODEs, this corresponds to aiCi(F)R(F)Δt. Comparing both terms above, for chasing pairs, we have ail=2ril(C)L−2uCi−Rl¯=2ril(C)L−2vCi2+vRl2. Likewise, for interference pairs, we obtain aij′=2rij(I)L−2uCi−Cj¯=2rij(I)L−2vCi2+vCj2. In particular, aii′=22vCirii(I)L−2.

Stochastic simulations
To investigate the impact of stochasticity on species coexistence, we use the stochastic simulation algorithm (SSA; Gillespie, 2007) and individual-based modeling (IBM; Vetsigian, 2017; Grimm, 2013) in simulating the stochastic process. In the SSA studies, we follow the standard Gillespie algorithm and simulation procedures (Gillespie, 2007).
In the IBM studies, we consider a 2D square system with a length of L and periodic boundary conditions. In the case of SC=2 and SR=1, consumers of species Ci move at speed vCi, while the resources move at speed vR. The unit length is Δl=1, and all individuals move probabilistically. Specifically, when Δt is small so that vCiΔt≪1, Ci individuals jump a unit length with the probability vCiΔt. In practice, we simulate the temporal evolution of the model system following the procedures below.
Initialization
We choose the initial position for each individual randomly from a uniform distribution in the square space, which rounds to the nearest integer point in the x-y coordinates.

Moving
We choose the destination of a movement randomly from four directions (x-positive, x-negative, y-positive, y-negative) following a uniform distribution. The consumers and resources jump a unit length with probabilities vCiΔt and vRΔt, respectively.

Forming pairs
When a Ci individual and a resource individual get close in space within a distance of r(C), they form a chasing pair. Meanwhile, when two consumer individuals Ci and Cj stand within a distance of r(I), they form an interference pair.

Dissociation
We update the system with a small time step Δt so that diΔt,kiΔt,dij′Δt≪1. In practice, a random number ς is sampled from a uniform distribution between 0 and 1, that is U(0,1). If ς&lt;diΔt or ς&lt;dij′Δt, then the chasing pair or interference pair dissociates into two separated individuals. One occupies the original position, while the other individual moves just out of the encounter radius in a uniformly distributed random angle. For a chasing pair, if diΔt&lt;ς&lt;(di+ki)Δt, then, the consumer catches the resource, and the biomass of the resource flows into the consumer populations (updated according to the birth procedure), while the consumer individual occupies the original position. Finally, if ς&gt;(di+ki)Δt or ς&gt;dij′Δt , the chasing pair or interference pair maintains the current status.

Birth and death
For each species, we use two separate counters with decimal precision to record the contributions of the birth and death processes, both of which accumulate in each time step. The incremental integer part of the counter will trigger updates in this run. Specifically, a newborn would join the system following the initialization procedure in a birth action, while an unfortunate target would be randomly chosen from the living population in a death action.

